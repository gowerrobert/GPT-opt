To use srun run:

srun --gpus=1 --cpus-per-gpu=8 --time=150:00:00 --partition=gpu --constraint=a100 --pty bash
module load python

# Activate environment
source gptopt/bin/activate

# Install the necessary packages
python3.9 -m pip install -e . 

# Run the Python script with the config file:
python3.9 run.py --config $1

# For plotting:
module load texlive
python3.9 plot.py --config configs/shakespeare.yaml 

See my jobs running: 

squeue --format="%.18i %.9P %.30j %.8u %.8T %.10M %.9l %.6D %R" --me

Check the version of torch
python3.9 -c "import torch; print(torch.version.cuda)"

Check the system version of CUDA
nvcc --version

Check if GPU is visible
nvidia-smi